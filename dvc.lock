schema: '2.0'
stages:
  sample proGenomes:
    cmd: cargo run --release --manifest-path src/samplefa/Cargo.toml -- --input data/progenomes/freeze12.contigs.representatives.fasta.gz
      --output data/progenomes/freeze12.contigs.representatives.randomly_selected.fasta
      --seed 42 --min-size 250000 --total 5000
    deps:
    - path: data/progenomes/freeze12.contigs.representatives.fasta.gz
      md5: 358e315953bdf2e35d5b9b4621a4100f
      size: 45496886542
    - path: src/samplefa/Cargo.lock
      md5: 74c4bba672f18bcc670911feb2227289
      size: 23065
    - path: src/samplefa/Cargo.toml
      md5: bd58f87e53c9dae8446665075dcfb16f
      size: 306
    - path: src/samplefa/main.rs
      md5: 3beae1dec378b5c11ecd586f26a0e8f5
      size: 3034
    outs:
    - path: data/progenomes/freeze12.contigs.representatives.randomly_selected.fasta
      md5: c03b77c87046303824d7d6e886c0db9c
      size: 4664432955
  deduplicate selected proGenomes contigs:
    cmd: python -m src.dedupbyani --input data/progenomes/freeze12.contigs.representatives.randomly_selected.fasta
      --list data/progenomes/freeze12.contigs.representatives.deduplicated.txt --6genomes
      data/6genomes --9genomes data/9genomes --total 5000
    deps:
    - path: data/6genomes/Anabaena_variabilis_ATCC_29413_NC_007413.1.gbk
      md5: 1217459ff670912d292dbeb3739cfb2c
      size: 14429007
    - path: data/6genomes/Pseudomonas_fluorescens_Pf-5_NC_004129.6.gbk
      md5: 5d8c7be6fcb7cc530f8afc4e6aa0cdf9
      size: 16743028
    - path: data/6genomes/Saccharopolyspora_erythraea_NRRL_2338_AM420293.1.gbk
      md5: 527a13e9b1a04e87ebbaa79b65a2f5a4
      size: 19520870
    - path: data/6genomes/Salinispora_tropica_CNB-440_NC_009380.1.gbk
      md5: cdbfcc39826aa2e8b948298e256e3789
      size: 12671477
    - path: data/6genomes/Sorangium_cellulosum_So_ce_56_AM746676.1.gbk
      md5: a29feeab2969a4cfabb607f6f848e01e
      size: 29273578
    - path: data/6genomes/Streptomyces_griseus_griseus_NBRC_13350_AP009493.1.gbk
      md5: 4622e4fb76c0a5ebcd85bc910bafa4e3
      size: 17135358
    - path: data/9genomes/Kutzneria_sp_744_KK037166.1.gbk
      md5: acb095d3c274c40d83b14c25b6b84aeb
      size: 23378429
    - path: data/9genomes/Micromonospora_sp_ATCC_39149_GG657738.1.gbk
      md5: 0584a1bf8475af7a890c0477f7a4ef3f
      size: 13375949
    - path: data/9genomes/Micromonospora_sp_M42_KK037233.1.gbk
      md5: da590a952cb8d3b9713b36c2f6ef4caf
      size: 13518914
    - path: data/9genomes/Streptomyces_albidoflavus_strain_J1074_DS999645.1.gbk
      md5: b12852a96075e5d166639f5112f65f04
      size: 13559612
    - path: data/9genomes/Streptomyces_ghanaensis_ATCC_14672_DS999641.1.gbk
      md5: cea09b4472670061a1526f5145eaf5d2
      size: 16622522
    - path: data/9genomes/Streptomyces_ghanaensis_ATCC_14672_DS999642.1.gbk
      md5: d0ecab5c5e6f9b7dd79983358e4ca7fd
      size: 468023
    - path: data/9genomes/Streptomyces_hygroscopicus_ATCC_53653_GG657754.1.gbk
      md5: f6965fc722cfa346d0a54acacdea4e9d
      size: 21666747
    - path: data/9genomes/Streptomyces_pristinaespiralis_ATCC_25486_CM000950.1.gbk
      md5: 292bccac3afc2c55419cfc0e4c84989e
      size: 16007684
    - path: data/9genomes/Streptomyces_sp_AA4_GG657746.1.gbk
      md5: 563f4e2df0ecb787b319b6ab68b41472
      size: 17219028
    - path: data/9genomes/Streptomyces_sp_AA4_GG657747.1.gbk
      md5: b41f74cbba07fa36dda9c54282317902
      size: 678230
    - path: data/9genomes/Streptomyces_sp_C_GG657750.1.gbk
      md5: 67e02c993ed01e3ad1f8e44a89a45484
      size: 14851803
    - path: data/9genomes/Streptomyces_sp_C_GG657751.1.gbk
      md5: 9f17c7d1ca8685f4b732c24662aeb9b8
      size: 1268276
    - path: data/9genomes/Streptomyces_sp_C_GG657752.1.gbk
      md5: 022bdadc3798c4ceb969dbeabfddaf84
      size: 698374
    - path: data/progenomes/freeze12.contigs.representatives.randomly_selected.fasta
      md5: c03b77c87046303824d7d6e886c0db9c
      size: 4664432955
    outs:
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.txt
      md5: a0dddd47b3a8df3b34decdbe83ae086d
      size: 94266
  extract deduplicated proGenomes contigs:
    cmd: cargo run --release --manifest-path src/extractfa/Cargo.toml -- --input data/progenomes/freeze12.contigs.representatives.fasta.gz
      --list data/progenomes/freeze12.contigs.representatives.deduplicated.txt --output
      data/progenomes/freeze12.contigs.representatives.deduplicated.fasta
    deps:
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.txt
      md5: a0dddd47b3a8df3b34decdbe83ae086d
      size: 94266
    - path: data/progenomes/freeze12.contigs.representatives.fasta.gz
      md5: 358e315953bdf2e35d5b9b4621a4100f
      size: 45496886542
    outs:
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.fasta
      md5: 1a1365860ca0568eada8857fdb2d9d87
      size: 2848515075
  analyze deduplicated proGenomes contigs:
    cmd: antismash -v --skip-zip-file --genefinding-tool prodigal-m --output-dir data/antismash/freeze12.contigs.representatives.deduplicated
      --output-basename deduplicated data/progenomes/freeze12.contigs.representatives.deduplicated.fasta
    deps:
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.fasta
      md5: 1a1365860ca0568eada8857fdb2d9d87
      size: 2848515075
    outs:
    - path: data/antismash/freeze12.contigs.representatives.deduplicated/deduplicated.gbk
      md5: d81487d5242d0926b756ba5476d79c58
      size: 5229719053
    - path: data/antismash/freeze12.contigs.representatives.deduplicated/deduplicated.json
      md5: 50ee031d75e492593b7c498d68db9cca
      size: 4184127168
  remove biosynthetic regions from proGenomes contigs:
    cmd: python -m src.delregions --input data/antismash/freeze12.contigs.representatives.deduplicated/deduplicated.gbk
      --list data/progenomes/freeze12.contigs.representatives.deduplicated.txt --output
      data/progenomes/freeze12.contigs.representatives.cleaned.fasta
    deps:
    - path: data/antismash/freeze12.contigs.representatives.deduplicated/deduplicated.gbk
      md5: d81487d5242d0926b756ba5476d79c58
      size: 5229719053
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.txt
      md5: a0dddd47b3a8df3b34decdbe83ae086d
      size: 94266
    outs:
    - path: data/progenomes/freeze12.contigs.representatives.cleaned.fasta
      md5: b0d19234821b7ac5f3157b95572e11bc
      size: 2780715671
  analyze cleaned proGenomes contigs:
    cmd: antismash -v --skip-zip-file --genefinding-tool prodigal-m --output-dir data/antismash/freeze12.contigs.representatives.cleaned
      --output-basename cleaned data/progenomes/freeze12.contigs.representatives.cleaned.fasta
    deps:
    - path: data/progenomes/freeze12.contigs.representatives.cleaned.fasta
      md5: b0d19234821b7ac5f3157b95572e11bc
      size: 2780715671
    outs:
    - path: data/antismash/freeze12.contigs.representatives.cleaned/cleaned.gbk
      md5: bad8a4b0e50c3d25f3ab0f98e47b668a
      size: 4957775836
    - path: data/antismash/freeze12.contigs.representatives.cleaned/cleaned.json
      md5: 40a2810eee016ca89f6e8294cb415b2a
      size: 3949516359
  make MIBiG_1_3 embeddings:
    cmd: python -m src.embed --input data/antismash/freeze12.contigs.representatives.cleaned/cleaned.gbk
      --list data/progenomes/freeze12.contigs.representatives.deduplicated.txt --mibig
      data/mibig/ --version 1.3 --output-prefix data/embeddings/mibig-1.3.proG2 --retire
      data/mibig/retire.txt
    deps:
    - path: data/antismash/freeze12.contigs.representatives.cleaned/cleaned.gbk
      md5: bad8a4b0e50c3d25f3ab0f98e47b668a
      size: 4957775836
    - path: data/mibig/mibig-1.3.gbk.tar.gz
      md5: 81bd2145cd56c234117f350821f9135e
      size: 38504232
    - path: data/mibig/mibig-1.3.json.tar.gz
      md5: 94b3a761323709d06b663232f30210b4
      size: 464561
    - path: data/mibig/mibig-1.4.json.tar.gz
      md5: a85530571d9dd7978b1bb0f2580cd30e
      size: 541377
    - path: data/mibig/mibig-2.0.json.tar.gz
      md5: 843ce4677db6d11422f0e6d94dd03e81
      size: 581956
    - path: data/mibig/retire.txt
      md5: aa678a56409585e376485639dd67d705
      size: 2920
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.txt
      md5: a0dddd47b3a8df3b34decdbe83ae086d
      size: 94266
    outs:
    - path: data/embeddings/mibig-1.3.proG2.clusters.tsv
      md5: 123c708268c484f149d115990568ada1
      size: 92658
    - path: data/embeddings/mibig-1.3.proG2.fna
      md5: 83cfc9bcc2839824cd97c97a10dcb4c8
      size: 1225172555
    - path: data/embeddings/mibig-1.3.proG2.gbk
      md5: f7177a6d06449991924546257d1a358d
      size: 2185040474
  make MIBiG_2_0 embeddings:
    cmd: python -m src.embed --input data/antismash/freeze12.contigs.representatives.cleaned/cleaned.gbk
      --list data/progenomes/freeze12.contigs.representatives.deduplicated.txt --mibig
      data/mibig/ --version 2.0 --output-prefix data/embeddings/mibig-2.0.proG2 --retire
      data/mibig/retire.txt
    deps:
    - path: data/antismash/freeze12.contigs.representatives.cleaned/cleaned.gbk
      md5: bad8a4b0e50c3d25f3ab0f98e47b668a
      size: 4957775836
    - path: data/mibig/mibig-1.3.json.tar.gz
      md5: 94b3a761323709d06b663232f30210b4
      size: 464561
    - path: data/mibig/mibig-1.4.json.tar.gz
      md5: a85530571d9dd7978b1bb0f2580cd30e
      size: 541377
    - path: data/mibig/mibig-2.0.gbk.tar.gz
      md5: 59f21b26a12405a80bc44e9c8459bce0
      size: 58781437
    - path: data/mibig/mibig-2.0.json.tar.gz
      md5: 843ce4677db6d11422f0e6d94dd03e81
      size: 581956
    - path: data/mibig/retire.txt
      md5: aa678a56409585e376485639dd67d705
      size: 2920
    - path: data/progenomes/freeze12.contigs.representatives.deduplicated.txt
      md5: a0dddd47b3a8df3b34decdbe83ae086d
      size: 94266
    outs:
    - path: data/embeddings/mibig-2.0.proG2.clusters.tsv
      md5: 8c8d2cce25e2d85f689cabdd9ae3c3a0
      size: 125996
    - path: data/embeddings/mibig-2.0.proG2.fna
      md5: 01ef24c576b948a3da9667516f17a5f2
      size: 1689042989
    - path: data/embeddings/mibig-2.0.proG2.gbk
      md5: 72c42ecaf3f4a78ad5728d876157a241
      size: 3107716320
  index MIBiG_1_3 FASTA embedding:
    cmd: samtools faidx data/embeddings/mibig-1.3.proG2.fna
    deps:
    - path: data/embeddings/mibig-1.3.proG2.fna
      md5: 83cfc9bcc2839824cd97c97a10dcb4c8
      size: 1225172555
    outs:
    - path: data/embeddings/mibig-1.3.proG2.fna.fai
      md5: 09380d57c4651a389839cb009ee11845
      size: 77224
  index MIBiG_2_0 FASTA embedding:
    cmd: samtools faidx data/embeddings/mibig-2.0.proG2.fna
    deps:
    - path: data/embeddings/mibig-2.0.proG2.fna
      md5: 01ef24c576b948a3da9667516f17a5f2
      size: 1689042989
    outs:
    - path: data/embeddings/mibig-2.0.proG2.fna.fai
      md5: bcd11573d7e46b306781770875f2b02b
      size: 105772
  annotate MIBiG_1_3 embeddings with Pfam_33_1:
    cmd: src/annotate/gecco-annotate-slurm.sh data/embeddings/mibig-1.3.proG2.fna.fai
      data/hmms/Pfam-v33.1.hmm.gz
    deps:
    - path: data/embeddings/mibig-1.3.proG2.fna.fai
      md5: 09380d57c4651a389839cb009ee11845
      size: 77224
    - path: data/hmms/Pfam-v33.1.hmm.gz
      md5: 4779cab2287dc3adbbb9fabd26a04540
      size: 274119400
    outs:
    - path: data/embeddings/mibig-1.3.proG2.Pfam-v33.1.features.tsv
      md5: 3a4dde547ff40937ef72fce86a00736c
      size: 1000863830
  annotate MIBiG_1_3 embeddings with Pfam_34_0:
    cmd: src/annotate/gecco-annotate-slurm.sh data/embeddings/mibig-1.3.proG2.fna.fai
      data/hmms/Pfam-v34.0.hmm.gz
    deps:
    - path: data/embeddings/mibig-1.3.proG2.fna.fai
      md5: 09380d57c4651a389839cb009ee11845
      size: 77224
    - path: data/hmms/Pfam-v34.0.hmm.gz
      md5: 5a6a03ac127c24854ae4e90cd027fe99
      size: 286543529
    outs:
    - path: data/embeddings/mibig-1.3.proG2.Pfam-v34.0.features.tsv
      md5: df6f2fd06b01a7f931ccff7b96c99312
      size: 1008075135
  annotate MIBiG_1_3 embeddings with Tigrfam_15_0:
    cmd: src/annotate/gecco-annotate-slurm.sh data/embeddings/mibig-1.3.proG2.fna.fai
      data/hmms/Tigrfam-v15.0.hmm.gz
    deps:
    - path: data/embeddings/mibig-1.3.proG2.fna.fai
      md5: 09380d57c4651a389839cb009ee11845
      size: 77224
    - path: data/hmms/Tigrfam-v15.0.hmm.gz
      md5: f00f8ca7718a96e609191873f532b57c
      size: 111129668
    outs:
    - path: data/embeddings/mibig-1.3.proG2.Tigrfam-v15.0.features.tsv
      md5: b2f7cde42645b88fd969ac77dcabf456
      size: 1219098220
  annotate MIBiG_1_3 embeddings with Pfam_31_0:
    cmd: src/annotate/gecco-annotate-slurm.sh data/embeddings/mibig-1.3.proG2.fna.fai
      data/hmms/Pfam-v31.0.hmm.gz
    deps:
    - path: data/embeddings/mibig-1.3.proG2.fna.fai
      md5: 09380d57c4651a389839cb009ee11845
      size: 77224
    - path: data/hmms/Pfam-v31.0.hmm.gz
      md5: b6fda5fdc90d24fbc1484d3b641d4e32
      size: 257664436
    outs:
    - path: data/embeddings/mibig-1.3.proG2.Pfam-v31.0.features.tsv
      md5: 3d4485e688f7727ed56b6f20d27b108e
      size: 984848084
